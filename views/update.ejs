<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Coding Bolog</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <link rel='stylesheet' href='/stylesheets/style.css'/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <link href="/ckeditor/plugins/codesnippet/lib/highlight/styles/default.css" rel="stylesheet">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="/ckeditor/plugins/codesnippet/lib/highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/ckeditor/ckeditor.js"></script>
    <script type="text/javascript" src="http://jsgetip.appspot.com"></script>
  </head>
  <body>
    <form action="/update" method="post" onsubmit="return checkSubmit()">
      <input type="hidden" name="idx" value="<%=row.idx%>"/>
      <input type="hidden" id="ip" name="ip">
      <input type="hidden" class="form-control" name="name" value="<%= row.name %>">
      <input type="hidden" name="hit" value="<%=row.hit%>">
      <div class="form-group">
        <label>제목</label>
        <input type="text" class="form-control" name="title" value="<%= row.title %>">
      </div>
      <div class="form-group">
        <label>내용</label>
        <textarea class="content" name="content"><%=row.content%></textarea>
      </div>
      <button type="submit" class="btn btn-default">완료</button>
    </form>
    <script>
      function checkSubmit() {
        if ($("#title").val().trim() == "") {
          var message = "제목을 입력해 주세요";
          $("#title").val("");
          $("#title").focus();
          alert(message);
          return false;
        }

        // ckeditor 본문내용 공백체크
        if ($("#cke_1_contents iframe").contents().find("body").text().trim() == "") {
          var message = "본문 내용을 입력해 주세요";
          alert(message);
          console.log($("#cke_1_contents iframe").contents().find("body").text());
          return false;
        }
        return true;
      }

      // ckeditor사용코드
      CKEDITOR.replace('content');

      // 사용자 아이피주소 받기
      document.getElementById('ip').value = ip();
    </script>
  </body>
</html>
