<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Coding Bolog</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <link rel='stylesheet' href='/stylesheets/style.css'/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <link href="/ckeditor/plugins/codesnippet/lib/highlight/styles/default.css" rel="stylesheet">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="/ckeditor/plugins/codesnippet/lib/highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/ckeditor/ckeditor.js"></script>
    <script type="text/javascript" src="http://jsgetip.appspot.com"></script>
  </head>
  <body>
    <%
      if(sess) {
    %>
        <h1><%=sess.name%></h1>
        <h1><%=sess.idx%></h1>
    <%
      }
    %>
    <form method="post" onsubmit="return checkSubmit()">
        <input type="hidden" id="ip" name="ip">
        <input type="hidden" id="date" name="date">
        <input type="hidden" name="name" value="<%=sess.name%>">
        <input type="hidden" name="user_idx" value="<%=sess.idx%>">
        <div class="form-group">
            <label>카테고리</label>
            <select class="form-control" name="tag">
              <option value="1">Nodejs</option>
              <option value="2">JAVA</option>
              <option value="3">PHP</option>
              <option value="4">JSP</option>
              <option value="5">MTML</option>
              <option value="6">Css</option>
              <option value="7">javascript</option>
              <option value="8">jquery</option>
              <option value="9">python</option>
              <option value="10">angularjs</option>
            </select>
        </div>
        <div class="form-group">
            <label>제목</label>
            <input type="text" class="form-control" id="title" name="title" placeholder="제목을 입력하세요">
        </div>
        <div class="form-group">
            <label>내용</label>
            <textarea id="content" name="content"></textarea>
        </div>
        <button type="submit" class="btn btn-default">완료</button>
    </form>

    <script>
      // 글쓰기 양식 확인
      function checkSubmit() {
        if ($("#title").val().trim() == "") {
          var message = "제목을 입력해 주세요";
          $("#title").val("");
          $("#title").focus();
          alert(message);
          return false;
        }

        // ckeditor 본문내용 공백체크
        if ($("#cke_1_contents iframe").contents().find("body").text().trim() == "") {
          var message = "본문 내용을 입력해 주세요";
          alert(message);
          console.log($("#cke_1_contents iframe").contents().find("body").text());
          return false;
        }
        return true;
      }

      // ckeditor사용코드
      CKEDITOR.replace('content');

      // 사용자 아이피주소 받기
      document.getElementById('ip').value = ip();
      // 현재 날짜 받아서 넣어주기
      document.getElementById('date').value = Date();
    </script>
</body>

</html>
